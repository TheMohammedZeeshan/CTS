[0m10:03:21.433191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79567475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7956283bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7956beab10>]}


============================== 10:03:21.436129 | 1a4355a5-0385-4658-9495-e393190ba8f8 ==============================
[0m10:03:21.436129 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:03:21.436559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:03:21.767007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79582408c0>]}
[0m10:03:21.823151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7954a261b0>]}
[0m10:03:21.823944 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:03:21.901678 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:03:21.902289 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:03:21.902601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a795475e090>]}
[0m10:03:23.181345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7953a80650>]}
[0m10:03:23.251234 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:03:23.252651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:03:23.267335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7953821b20>]}
[0m10:03:23.267776 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 476 macros
[0m10:03:23.268090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a795380c650>]}
[0m10:03:23.269853 [info ] [MainThread]: 
[0m10:03:23.270367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:23.270636 [info ] [MainThread]: 
[0m10:03:23.271106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:03:23.275950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m10:03:23.313107 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:03:23.313452 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:03:23.313689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:26.214812 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.901 seconds
[0m10:03:26.221675 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:03:26.222136 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:03:26.681813 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.459 seconds
[0m10:03:26.689860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:03:26.722057 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:03:26.722444 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:03:27.169205 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.446 seconds
[0m10:03:27.173918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m10:03:27.181120 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:03:27.181696 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:03:27.709477 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.527 seconds
[0m10:03:27.712124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79538514c0>]}
[0m10:03:27.717418 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m10:03:27.717885 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m10:03:27.718317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now model.clinicaltrials.stg_ctgov__studies)
[0m10:03:27.718702 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m10:03:27.724795 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:27.726482 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m10:03:27.756219 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:27.758708 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:27.759563 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:03:29.645441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.885 seconds
[0m10:03:29.674013 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:29.674450 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:03:30.017629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m10:03:30.032492 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:30.032996 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m10:03:30.355909 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.322 seconds
[0m10:03:30.374039 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:03:30.374494 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:03:30.790113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m10:03:30.806005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7956c0f3e0>]}
[0m10:03:30.806570 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 3.09s]
[0m10:03:30.807344 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m10:03:30.808420 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m10:03:30.808800 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m10:03:30.809149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m10:03:30.809393 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m10:03:30.811698 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m10:03:30.812476 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m10:03:30.814364 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m10:03:30.815412 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:03:30.815752 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:03:32.149962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.334 seconds
[0m10:03:32.153759 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:03:32.154483 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:03:32.488423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m10:03:32.498536 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:03:32.499445 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m10:03:32.842183 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.340 seconds
[0m10:03:32.858643 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:03:32.859380 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:03:33.222295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m10:03:33.229491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4355a5-0385-4658-9495-e393190ba8f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7953a46330>]}
[0m10:03:33.232279 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 2.42s]
[0m10:03:33.235144 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m10:03:33.242828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:33.244267 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m10:03:33.245178 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m10:03:33.815707 [info ] [MainThread]: 
[0m10:03:33.816837 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m10:03:33.818927 [debug] [MainThread]: Command end result
[0m10:03:33.847074 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:03:33.848600 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:03:33.853202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:03:33.853475 [info ] [MainThread]: 
[0m10:03:33.853794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:33.854016 [info ] [MainThread]: 
[0m10:03:33.854254 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:03:33.855135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.476308, "process_in_blocks": "0", "process_kernel_time": 0.686796, "process_mem_max_rss": "147504", "process_out_blocks": "5480", "process_user_time": 3.713491}
[0m10:03:33.855617 [debug] [MainThread]: Command `dbt run` succeeded at 10:03:33.855530 after 12.48 seconds
[0m10:03:33.855945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a79567475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a795a2eb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a795a2eb3b0>]}
[0m10:03:33.856566 [debug] [MainThread]: Flushing usage events
[0m10:03:35.229743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:11.425806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedff2b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee004d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedff360e90>]}


============================== 10:10:11.428651 | 1fdc9086-bff4-47e5-b1fe-c027815bc158 ==============================
[0m10:10:11.428651 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:10:11.429083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:11.770058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd7f3d10>]}
[0m10:10:11.829897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd626a20>]}
[0m10:10:11.830629 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:10:11.908001 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:10:12.091913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:12.092268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:12.132741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd5ed3d0>]}
[0m10:10:12.207326 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:10:12.208809 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:10:12.220930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd1118b0>]}
[0m10:10:12.221338 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 476 macros
[0m10:10:12.221672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd407230>]}
[0m10:10:12.222999 [info ] [MainThread]: 
[0m10:10:12.223414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:12.223732 [info ] [MainThread]: 
[0m10:10:12.224142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:12.227834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m10:10:12.264509 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:10:12.264926 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:10:12.265165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:13.853999 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.589 seconds
[0m10:10:13.859639 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:10:13.860380 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:10:14.242612 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.382 seconds
[0m10:10:14.245954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage'
[0m10:10:14.261151 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:10:14.261579 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:10:14.261838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:15.844267 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.582 seconds
[0m10:10:15.849412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:10:15.853402 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:10:15.853777 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:10:16.287582 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.433 seconds
[0m10:10:16.290084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfd650920>]}
[0m10:10:16.293142 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m10:10:16.293770 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m10:10:16.294338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now model.clinicaltrials.stg_ctgov__studies)
[0m10:10:16.294724 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m10:10:16.302198 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:16.302845 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m10:10:16.331042 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:16.332613 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:16.332969 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:10:17.604413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m10:10:17.628602 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:17.629170 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:10:17.943878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m10:10:17.971861 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:17.972464 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m10:10:18.306405 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.333 seconds
[0m10:10:18.332044 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:10:18.332811 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:10:18.718451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m10:10:18.738014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedffa07470>]}
[0m10:10:18.739057 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 2.44s]
[0m10:10:18.740008 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m10:10:18.741349 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m10:10:18.741995 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m10:10:18.742587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m10:10:18.743002 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m10:10:18.746769 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m10:10:18.747766 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m10:10:18.761773 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m10:10:18.763477 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:10:18.764001 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:10:19.887767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.123 seconds
[0m10:10:19.890721 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:10:19.891211 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:10:20.250568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m10:10:20.256669 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:10:20.257448 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m10:10:20.564149 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.305 seconds
[0m10:10:20.574957 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:10:20.575311 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:10:20.906253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m10:10:20.910443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fdc9086-bff4-47e5-b1fe-c027815bc158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfc4d57f0>]}
[0m10:10:20.910988 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 2.17s]
[0m10:10:20.911461 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m10:10:20.912731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:20.912994 [debug] [MainThread]: Connection 'list_DB_CLINICAL_TRIALS_GOV' was left open.
[0m10:10:20.913214 [debug] [MainThread]: On list_DB_CLINICAL_TRIALS_GOV: Close
[0m10:10:21.402182 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m10:10:21.403136 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m10:10:21.965025 [info ] [MainThread]: 
[0m10:10:21.965633 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.74 seconds (9.74s).
[0m10:10:21.966314 [debug] [MainThread]: Command end result
[0m10:10:21.982928 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:10:21.984290 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:10:21.989397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:10:21.989710 [info ] [MainThread]: 
[0m10:10:21.990031 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:21.990261 [info ] [MainThread]: 
[0m10:10:21.990548 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:10:21.991522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.620601, "process_in_blocks": "0", "process_kernel_time": 0.27104, "process_mem_max_rss": "141372", "process_out_blocks": "2080", "process_user_time": 2.475771}
[0m10:10:21.991989 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:21.991901 after 10.62 seconds
[0m10:10:21.992305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee02817080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfc637ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cedfdeea6f0>]}
[0m10:10:21.992618 [debug] [MainThread]: Flushing usage events
[0m10:10:22.967850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:27.128012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3e0551460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dee2b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3ddeb1a60>]}


============================== 10:10:27.130839 | 90071740-63e9-4536-a0c8-85941d486b5d ==============================
[0m10:10:27.130839 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:10:27.131385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m10:10:27.466741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3de9987d0>]}
[0m10:10:27.519815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dc9f1490>]}
[0m10:10:27.520505 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:10:27.587473 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:10:27.847697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:27.848220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:27.886989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dc7004a0>]}
[0m10:10:28.020905 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:10:28.022326 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:10:28.050619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dc4a7fb0>]}
[0m10:10:28.051142 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 476 macros
[0m10:10:28.051608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dc47e5d0>]}
[0m10:10:28.053060 [info ] [MainThread]: 
[0m10:10:28.053427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:28.053777 [info ] [MainThread]: 
[0m10:10:28.054286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:28.055191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage'
[0m10:10:28.095284 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:10:28.095719 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:10:28.095987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:29.772703 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.677 seconds
[0m10:10:29.774295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:10:29.776428 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:10:29.776906 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:10:30.097338 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.320 seconds
[0m10:10:30.101108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90071740-63e9-4536-a0c8-85941d486b5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3db7eb110>]}
[0m10:10:30.104783 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:10:30.105562 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m10:10:30.106290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m10:10:30.106746 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:10:30.126796 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:10:30.127845 [error] [Thread-1 (]: 1 of 2 ERROR dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[31mERROR[0m in 0.02s]
[0m10:10:30.128602 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:10:30.129012 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:10:30.130092 [debug] [Thread-4 (]: Marking all children of 'test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:10:30.129408 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m10:10:30.133177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m10:10:30.133865 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:10:30.145264 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:10:30.146451 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:10:30.174380 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:10:30.175752 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:10:30.176173 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m10:10:30.502138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m10:10:30.512786 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.38s]
[0m10:10:30.514025 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:10:30.517188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:30.517850 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m10:10:30.518334 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m10:10:31.075310 [info ] [MainThread]: 
[0m10:10:31.076116 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m10:10:31.077302 [debug] [MainThread]: Command end result
[0m10:10:31.161983 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:10:31.164273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:10:31.188520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:10:31.189090 [info ] [MainThread]: 
[0m10:10:31.190027 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:10:31.190516 [info ] [MainThread]: 
[0m10:10:31.190982 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)[0m
[0m10:10:31.191377 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:10:31.191707 [info ] [MainThread]: 
[0m10:10:31.191953 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:10:31.192833 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.116684, "process_in_blocks": "0", "process_kernel_time": 0.3578, "process_mem_max_rss": "141896", "process_out_blocks": "2040", "process_user_time": 2.590971}
[0m10:10:31.193421 [debug] [MainThread]: Command `dbt test` failed at 10:10:31.193277 after 4.12 seconds
[0m10:10:31.193808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3def842f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3de5c35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3dc457080>]}
[0m10:10:31.194168 [debug] [MainThread]: Flushing usage events
[0m10:10:32.192548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:11.104055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d89abbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d89d265a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d893e1b20>]}


============================== 10:11:11.107954 | 475a7717-a922-4bea-860e-fbf4993ee3f1 ==============================
[0m10:11:11.107954 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:11:11.108541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:11.434892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d87ebc680>]}
[0m10:11:11.506394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d87f6b3e0>]}
[0m10:11:11.507316 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:11:11.612621 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:11:11.789169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:11.789792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:11.832263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d87e54350>]}
[0m10:11:11.905918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:11:11.908032 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:11:11.918010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d87915940>]}
[0m10:11:11.918447 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 476 macros
[0m10:11:11.918757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d87dbdfa0>]}
[0m10:11:11.920230 [info ] [MainThread]: 
[0m10:11:11.920592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:11.920858 [info ] [MainThread]: 
[0m10:11:11.921284 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:11.925865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m10:11:11.959543 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:11:11.959940 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:11:11.960190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:13.519766 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.559 seconds
[0m10:11:13.526844 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:11:13.527337 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:11:13.853765 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.326 seconds
[0m10:11:13.860412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:11:13.873662 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:11:13.874024 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:11:14.210004 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.336 seconds
[0m10:11:14.214312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m10:11:14.222929 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:11:14.223956 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:11:14.542271 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.317 seconds
[0m10:11:14.549700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d89329b50>]}
[0m10:11:14.557154 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m10:11:14.558307 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m10:11:14.559105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now model.clinicaltrials.stg_ctgov__studies)
[0m10:11:14.559971 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m10:11:14.572229 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:14.573202 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m10:11:14.603519 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:14.605148 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:14.605547 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:11:15.693984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.088 seconds
[0m10:11:15.722620 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:15.723037 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:11:16.086965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m10:11:16.118819 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:16.119350 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m10:11:16.440556 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.320 seconds
[0m10:11:16.460686 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:11:16.461103 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:11:16.810621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m10:11:16.823298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d86e46f90>]}
[0m10:11:16.823960 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 2.26s]
[0m10:11:16.824456 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m10:11:16.825342 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m10:11:16.825709 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m10:11:16.826053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m10:11:16.826309 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m10:11:16.828492 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m10:11:16.828984 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m10:11:16.830807 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m10:11:16.831753 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:11:16.832049 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:11:17.745950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m10:11:17.751612 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:11:17.752541 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:11:18.057668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m10:11:18.062938 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:11:18.063713 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m10:11:18.372919 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.309 seconds
[0m10:11:18.386017 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m10:11:18.386883 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m10:11:18.717100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m10:11:18.720169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '475a7717-a922-4bea-860e-fbf4993ee3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d86c60f20>]}
[0m10:11:18.721093 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 1.89s]
[0m10:11:18.722001 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m10:11:18.723977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:18.724580 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m10:11:18.725052 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m10:11:19.261937 [info ] [MainThread]: 
[0m10:11:19.263177 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m10:11:19.265661 [debug] [MainThread]: Command end result
[0m10:11:19.310191 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:11:19.311701 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:11:19.316656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:11:19.316984 [info ] [MainThread]: 
[0m10:11:19.317331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:19.317603 [info ] [MainThread]: 
[0m10:11:19.317875 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:11:19.318625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.2705765, "process_in_blocks": "0", "process_kernel_time": 0.290992, "process_mem_max_rss": "140656", "process_out_blocks": "2080", "process_user_time": 2.489986}
[0m10:11:19.319282 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:19.319140 after 8.27 seconds
[0m10:11:19.319836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8a1e6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8a20a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3d8bbc45c0>]}
[0m10:11:19.320152 [debug] [MainThread]: Flushing usage events
[0m10:11:20.359568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:24.250452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab0cb6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab2c8d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab2dc4530>]}


============================== 10:11:24.254078 | 233ed4e0-4d0a-4b90-b875-081a4d132f67 ==============================
[0m10:11:24.254078 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:11:24.254543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:24.573024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab0378f20>]}
[0m10:11:24.630018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753aaf413f20>]}
[0m10:11:24.630794 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:11:24.700676 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:11:24.842418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:24.842752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:24.879072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753aaee30740>]}
[0m10:11:24.955718 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:11:24.957374 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:11:24.977749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753aaebcf6e0>]}
[0m10:11:24.978220 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 476 macros
[0m10:11:24.978534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab0503920>]}
[0m10:11:24.980056 [info ] [MainThread]: 
[0m10:11:24.980399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:24.980636 [info ] [MainThread]: 
[0m10:11:24.981059 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:24.981994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage'
[0m10:11:25.020401 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:11:25.020776 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:11:25.021021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:27.207108 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.186 seconds
[0m10:11:27.209200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:11:27.212077 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:11:27.212456 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:11:27.767051 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.554 seconds
[0m10:11:27.771220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233ed4e0-4d0a-4b90-b875-081a4d132f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753aaf08ad80>]}
[0m10:11:27.775742 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:11:27.776190 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m10:11:27.776684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m10:11:27.776985 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:11:27.791904 [debug] [Thread-1 (]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:11:27.792428 [error] [Thread-1 (]: 1 of 2 ERROR dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[31mERROR[0m in 0.02s]
[0m10:11:27.792929 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:11:27.793263 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:11:27.793561 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m10:11:27.794167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m10:11:27.795608 [debug] [Thread-4 (]: Marking all children of 'test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:11:27.796280 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:11:27.803881 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:11:27.804452 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:11:27.824235 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:11:27.825069 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:11:27.825374 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m10:11:28.705502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m10:11:28.725529 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.93s]
[0m10:11:28.726504 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:11:28.728659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:28.729196 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m10:11:28.729584 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m10:11:29.457252 [info ] [MainThread]: 
[0m10:11:29.458591 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m10:11:29.460884 [debug] [MainThread]: Command end result
[0m10:11:29.489012 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:11:29.490342 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:11:29.496237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:11:29.496651 [info ] [MainThread]: 
[0m10:11:29.497017 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:11:29.497301 [info ] [MainThread]: 
[0m10:11:29.497620 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)[0m
[0m10:11:29.497937 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False (models/stg_ctgov__studies.yaml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:11:29.498181 [info ] [MainThread]: 
[0m10:11:29.498407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:11:29.499157 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.3150997, "process_in_blocks": "0", "process_kernel_time": 0.357279, "process_mem_max_rss": "141884", "process_out_blocks": "2040", "process_user_time": 2.197064}
[0m10:11:29.499701 [debug] [MainThread]: Command `dbt test` failed at 10:11:29.499592 after 5.32 seconds
[0m10:11:29.500081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab13e5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753ab1248d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753aaee04d10>]}
[0m10:11:29.500418 [debug] [MainThread]: Flushing usage events
[0m10:11:30.520777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:37.243342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844433234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844433235c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844430e0fb0>]}


============================== 10:12:37.246065 | 5e8bf053-3d78-4efd-90f8-213524d06309 ==============================
[0m10:12:37.246065 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:12:37.246597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:12:37.356508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8bf053-3d78-4efd-90f8-213524d06309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844422c35f0>]}
[0m10:12:37.366299 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:12:37.367332 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:12:37.368849 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20218572, "process_in_blocks": "0", "process_kernel_time": 0.188447, "process_mem_max_rss": "100148", "process_out_blocks": "16", "process_user_time": 1.671973}
[0m10:12:37.369446 [debug] [MainThread]: Command `dbt deps` succeeded at 10:12:37.369322 after 0.20 seconds
[0m10:12:37.369851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784442bcf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78444319dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844431c5850>]}
[0m10:12:37.370222 [debug] [MainThread]: Flushing usage events
[0m10:12:38.521411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:14.760959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9f951370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9dd9ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9f35c3b0>]}


============================== 10:14:14.763975 | 4e19d6ba-2cf5-4050-85e3-05c66189339e ==============================
[0m10:14:14.763975 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:14:14.764465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:14.901798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e19d6ba-2cf5-4050-85e3-05c66189339e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9d10f3e0>]}
[0m10:14:14.916934 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p8nsvl7y'
[0m10:14:14.917453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:14:15.071826 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:14:15.074493 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m10:14:15.412405 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m10:14:15.417048 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m10:14:15.418074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e19d6ba-2cf5-4050-85e3-05c66189339e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9d147680>]}
[0m10:14:15.423759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m10:14:15.982812 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m10:14:15.994589 [info ] [MainThread]: Updating lock file in file path: /home/reach2zeeshan/clinicaltrials/package-lock.yml
[0m10:14:16.000009 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-5vxh6dno'
[0m10:14:16.004111 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m10:14:18.332382 [info ] [MainThread]: Installed from version 0.10.4
[0m10:14:18.332785 [info ] [MainThread]: Up to date!
[0m10:14:18.333167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e19d6ba-2cf5-4050-85e3-05c66189339e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9d0d8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9d5f1580>]}
[0m10:14:18.333512 [info ] [MainThread]: Installing calogica/dbt_date
[0m10:14:18.833393 [info ] [MainThread]: Installed from version 0.10.1
[0m10:14:18.833848 [info ] [MainThread]: Up to date!
[0m10:14:18.834341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e19d6ba-2cf5-4050-85e3-05c66189339e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9df3cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9df3c380>]}
[0m10:14:18.836162 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:14:18.837175 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.127936, "process_in_blocks": "0", "process_kernel_time": 0.319612, "process_mem_max_rss": "109260", "process_out_blocks": "20856", "process_user_time": 2.009561}
[0m10:14:18.837590 [debug] [MainThread]: Command `dbt deps` succeeded at 10:14:18.837510 after 4.13 seconds
[0m10:14:18.837839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9e0ba2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9e0b8fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8c9e0b9f10>]}
[0m10:14:18.838121 [debug] [MainThread]: Flushing usage events
[0m10:14:19.802475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:05.223961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c80546b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c8b0d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c7e15250>]}


============================== 10:15:05.227765 | a73173bf-b4a9-4391-9cd3-d5c753cb033c ==============================
[0m10:15:05.227765 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:15:05.228217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m10:15:05.571767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c6419d00>]}
[0m10:15:05.640972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c8742d20>]}
[0m10:15:05.642021 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:15:05.752554 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:15:05.884019 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m10:15:05.884461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c61799a0>]}
[0m10:15:07.382549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c55bf4a0>]}
[0m10:15:07.509482 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:15:07.511280 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:15:07.530748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c563e450>]}
[0m10:15:07.531193 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m10:15:07.531540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c55bfd70>]}
[0m10:15:07.532968 [info ] [MainThread]: 
[0m10:15:07.533313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:07.533546 [info ] [MainThread]: 
[0m10:15:07.533956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:07.534857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur'
[0m10:15:07.568960 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:15:07.569331 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:15:07.569574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:09.216080 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.646 seconds
[0m10:15:09.221111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m10:15:09.230390 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:15:09.231289 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:15:09.581991 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.350 seconds
[0m10:15:09.588388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73173bf-b4a9-4391-9cd3-d5c753cb033c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c55bf8f0>]}
[0m10:15:09.602476 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:15:09.603737 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m10:15:09.605311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m10:15:09.606733 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:15:09.618221 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m10:15:09.618707 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:15:09.641325 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m10:15:09.642293 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m10:15:09.642622 [debug] [Thread-1 (]: On test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and early_stop_rate >= 0 and early_stop_rate <= 1
)
 as expression


    from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"} */
[0m10:15:10.072298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m10:15:10.095913 [info ] [Thread-1 (]: 1 of 2 PASS dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[32mPASS[0m in 0.49s]
[0m10:15:10.097033 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m10:15:10.097694 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:15:10.098233 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m10:15:10.099001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m10:15:10.099685 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:15:10.112146 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:15:10.113068 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:15:10.118001 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:15:10.119021 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m10:15:10.120767 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m10:15:10.500167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m10:15:10.506527 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.41s]
[0m10:15:10.508497 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m10:15:10.512626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:10.513573 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m10:15:10.514363 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m10:15:11.122130 [info ] [MainThread]: 
[0m10:15:11.123349 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m10:15:11.126066 [debug] [MainThread]: Command end result
[0m10:15:11.159692 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:15:11.161304 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:15:11.166868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:15:11.167301 [info ] [MainThread]: 
[0m10:15:11.167880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:11.168184 [info ] [MainThread]: 
[0m10:15:11.168471 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:15:11.169238 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.001658, "process_in_blocks": "0", "process_kernel_time": 0.349365, "process_mem_max_rss": "147760", "process_out_blocks": "4864", "process_user_time": 3.822939}
[0m10:15:11.169641 [debug] [MainThread]: Command `dbt test` succeeded at 10:15:11.169562 after 6.00 seconds
[0m10:15:11.169918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2ca283f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c5fe0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2c61f06e0>]}
[0m10:15:11.170189 [debug] [MainThread]: Flushing usage events
[0m10:15:12.183790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:26.669775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f132e5b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f132872960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f132e5ad20>]}


============================== 10:21:26.675254 | 1cd2822c-a780-4e7d-9073-df04bf890a8c ==============================
[0m10:21:26.675254 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:21:26.675866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:27.318027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f130e33cb0>]}
[0m10:21:27.372259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f130c3eab0>]}
[0m10:21:27.373757 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:21:27.466671 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:21:27.691945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:27.692322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:27.733821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f130a3b7a0>]}
[0m10:21:27.826000 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:21:27.829378 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:21:27.851880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1308320c0>]}
[0m10:21:27.852325 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m10:21:27.852686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f131f64ef0>]}
[0m10:21:27.854752 [info ] [MainThread]: 
[0m10:21:27.855274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:27.855738 [info ] [MainThread]: 
[0m10:21:27.856367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:21:27.861843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m10:21:27.903939 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:21:27.904331 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:21:27.904586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:29.572314 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.667 seconds
[0m10:21:29.580650 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m10:21:29.581316 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m10:21:29.942419 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.361 seconds
[0m10:21:29.944708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m10:21:29.957072 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m10:21:29.957470 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m10:21:30.348449 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.391 seconds
[0m10:21:30.354102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m10:21:30.359774 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m10:21:30.360858 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m10:21:30.756334 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.395 seconds
[0m10:21:30.760693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f130d0c3b0>]}
[0m10:21:30.770382 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m10:21:30.771161 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m10:21:30.771937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now model.clinicaltrials.stg_ctgov__studies)
[0m10:21:30.772414 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m10:21:30.778817 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:21:30.781684 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m10:21:30.809788 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m10:21:30.813913 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m10:21:30.814287 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m10:21:31.160890 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdb3ed-0003-2dd6-0008-ec5600010e4a
[0m10:21:31.161448 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES' does not exist or not authorized.
[0m10:21:31.165694 [debug] [Thread-1 (]: Database Error in model stg_ctgov__studies (models/stage/stg_ctgov__studies.sql)
  002003 (42S02): SQL compilation error:
  Object 'DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES' does not exist or not authorized.
  compiled code at target/run/clinicaltrials/models/stage/stg_ctgov__studies.sql
[0m10:21:31.168854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cd2822c-a780-4e7d-9073-df04bf890a8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f130b17f20>]}
[0m10:21:31.169867 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[31mERROR[0m in 0.39s]
[0m10:21:31.170708 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m10:21:31.171702 [debug] [Thread-4 (]: Marking all children of 'model.clinicaltrials.stg_ctgov__studies' to be skipped because of status 'error'.  Reason: Database Error in model stg_ctgov__studies (models/stage/stg_ctgov__studies.sql)
  002003 (42S02): SQL compilation error:
  Object 'DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES' does not exist or not authorized.
  compiled code at target/run/clinicaltrials/models/stage/stg_ctgov__studies.sql.
[0m10:21:31.173882 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m10:21:31.174496 [info ] [Thread-1 (]: 2 of 2 SKIP relation sh_clinical_trials_gov_cur.int_sponsor_summary ............ [[33mSKIP[0m]
[0m10:21:31.175073 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m10:21:31.177228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:31.177743 [debug] [MainThread]: Connection 'model.clinicaltrials.stg_ctgov__studies' was left open.
[0m10:21:31.178115 [debug] [MainThread]: On model.clinicaltrials.stg_ctgov__studies: Close
[0m10:21:31.702219 [info ] [MainThread]: 
[0m10:21:31.703680 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m10:21:31.705512 [debug] [MainThread]: Command end result
[0m10:21:31.735493 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m10:21:31.736942 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m10:21:31.741843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m10:21:31.742179 [info ] [MainThread]: 
[0m10:21:31.742513 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:21:31.742765 [info ] [MainThread]: 
[0m10:21:31.743081 [error] [MainThread]: [31mFailure in model stg_ctgov__studies (models/stage/stg_ctgov__studies.sql)[0m
[0m10:21:31.743414 [error] [MainThread]:   Database Error in model stg_ctgov__studies (models/stage/stg_ctgov__studies.sql)
  002003 (42S02): SQL compilation error:
  Object 'DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES' does not exist or not authorized.
  compiled code at target/run/clinicaltrials/models/stage/stg_ctgov__studies.sql
[0m10:21:31.743833 [info ] [MainThread]: 
[0m10:21:31.744291 [info ] [MainThread]:   compiled code at target/compiled/clinicaltrials/models/stage/stg_ctgov__studies.sql
[0m10:21:31.744592 [info ] [MainThread]: 
[0m10:21:31.744860 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m10:21:31.745621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1324534, "process_in_blocks": "63240", "process_kernel_time": 0.599496, "process_mem_max_rss": "141828", "process_out_blocks": "3240", "process_user_time": 2.717664}
[0m10:21:31.746042 [debug] [MainThread]: Command `dbt run` failed at 10:21:31.745958 after 5.13 seconds
[0m10:21:31.746431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1353a82c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1328c98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f13083d010>]}
[0m10:21:31.746864 [debug] [MainThread]: Flushing usage events
[0m10:21:32.743960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:42.751209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018dafaf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018daf00ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018daa31760>]}


============================== 11:06:42.759797 | c74bbfc8-0c33-425f-b958-296388aa891f ==============================
[0m11:06:42.759797 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:06:42.760617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:43.516787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c47e57c0>]}
[0m11:06:43.572617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c4b83770>]}
[0m11:06:43.584876 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:06:43.711822 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:06:43.947243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:43.947607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:43.988556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018d9e9e000>]}
[0m11:06:44.070747 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:06:44.072349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:06:44.103266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c4461f40>]}
[0m11:06:44.103808 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m11:06:44.104180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c4308560>]}
[0m11:06:44.105708 [info ] [MainThread]: 
[0m11:06:44.106043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:44.106272 [info ] [MainThread]: 
[0m11:06:44.106713 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:44.110605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m11:06:44.218592 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m11:06:44.219053 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m11:06:44.219286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:45.880556 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.661 seconds
[0m11:06:45.886184 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m11:06:45.886630 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m11:06:46.196843 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.310 seconds
[0m11:06:46.199736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m11:06:46.214029 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m11:06:46.214401 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m11:06:46.551881 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.337 seconds
[0m11:06:46.556723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m11:06:46.564671 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m11:06:46.565670 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m11:06:46.909628 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.343 seconds
[0m11:06:46.914234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c46f91c0>]}
[0m11:06:46.928333 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m11:06:46.928997 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m11:06:46.929529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now model.clinicaltrials.stg_ctgov__studies)
[0m11:06:46.929963 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m11:06:46.937793 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:46.940865 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m11:06:46.966403 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:46.979284 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:46.979731 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:06:47.843332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m11:06:47.863724 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:47.864163 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:06:48.206509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m11:06:48.225658 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:48.226179 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m11:06:48.533941 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.307 seconds
[0m11:06:48.546254 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:06:48.546649 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:06:48.915676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m11:06:48.929811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018dc40b8c0>]}
[0m11:06:48.930892 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 2.00s]
[0m11:06:48.931537 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m11:06:48.932527 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m11:06:48.932898 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m11:06:48.933248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m11:06:48.933495 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m11:06:48.936386 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m11:06:48.937617 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m11:06:48.940400 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m11:06:48.942154 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:06:48.942481 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:06:50.297503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.354 seconds
[0m11:06:50.304078 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:06:50.305838 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:06:50.765115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m11:06:50.770079 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:06:50.770745 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m11:06:51.093698 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.322 seconds
[0m11:06:51.100725 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:06:51.101472 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:06:51.425738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m11:06:51.431190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c74bbfc8-0c33-425f-b958-296388aa891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018bf5217c0>]}
[0m11:06:51.432862 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 2.50s]
[0m11:06:51.437876 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m11:06:51.441926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:51.442662 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m11:06:51.443283 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m11:06:52.006675 [info ] [MainThread]: 
[0m11:06:52.007954 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m11:06:52.009997 [debug] [MainThread]: Command end result
[0m11:06:52.043651 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:06:52.045133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:06:52.050335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m11:06:52.050803 [info ] [MainThread]: 
[0m11:06:52.051392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:52.051770 [info ] [MainThread]: 
[0m11:06:52.052069 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:06:52.052881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.373499, "process_in_blocks": "37672", "process_kernel_time": 0.554773, "process_mem_max_rss": "220124", "process_out_blocks": "3256", "process_user_time": 3.055273}
[0m11:06:52.053311 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:52.053201 after 9.37 seconds
[0m11:06:52.053610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018dac5a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018c4492420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7018dcb21a30>]}
[0m11:06:52.053903 [debug] [MainThread]: Flushing usage events
[0m11:06:53.102049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:57.860287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4c61f6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4c3085580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4c258cb00>]}


============================== 11:06:57.863147 | fb7db4a5-7e35-468f-8b21-bdac95ef1a04 ==============================
[0m11:06:57.863147 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:06:57.863650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:58.543017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ae66dfa0>]}
[0m11:06:58.622064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4c171c0b0>]}
[0m11:06:58.622739 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:06:58.719275 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:06:58.833074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:58.833568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:58.878399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4acac56a0>]}
[0m11:06:58.959564 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:06:58.961065 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:06:58.981376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ac5aa390>]}
[0m11:06:58.981823 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m11:06:58.982111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4acb8ef60>]}
[0m11:06:59.039922 [info ] [MainThread]: 
[0m11:06:59.040375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:59.040618 [info ] [MainThread]: 
[0m11:06:59.041062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:59.042132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage'
[0m11:06:59.081454 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m11:06:59.081886 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m11:06:59.082143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:00.804640 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.722 seconds
[0m11:07:00.808139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m11:07:00.812555 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m11:07:00.813064 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m11:07:01.129888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.316 seconds
[0m11:07:01.135738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb7db4a5-7e35-468f-8b21-bdac95ef1a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ac5851f0>]}
[0m11:07:01.144128 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:07:01.145285 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m11:07:01.146392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m11:07:01.147394 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:07:01.173195 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:07:01.176744 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:07:01.198628 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:07:01.201021 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:07:01.201487 [debug] [Thread-1 (]: On test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and early_stop_rate >= 0 and early_stop_rate <= 1
)
 as expression


    from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"} */
[0m11:07:01.781765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m11:07:01.799280 [info ] [Thread-1 (]: 1 of 2 PASS dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[32mPASS[0m in 0.65s]
[0m11:07:01.800080 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:07:01.801014 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:07:01.801540 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m11:07:01.801980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m11:07:01.802297 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:07:01.808774 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:07:01.809713 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:07:01.812414 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:07:01.813311 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:07:01.813653 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m11:07:02.142806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m11:07:02.147897 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.35s]
[0m11:07:02.149376 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:07:02.154442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:02.155401 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m11:07:02.156231 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m11:07:02.698356 [info ] [MainThread]: 
[0m11:07:02.699660 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m11:07:02.702388 [debug] [MainThread]: Command end result
[0m11:07:02.731348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:07:02.733403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:07:02.739745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m11:07:02.740140 [info ] [MainThread]: 
[0m11:07:02.740471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:02.740729 [info ] [MainThread]: 
[0m11:07:02.741001 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:07:02.741795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.9325976, "process_in_blocks": "1144", "process_kernel_time": 0.392208, "process_mem_max_rss": "221144", "process_out_blocks": "3232", "process_user_time": 2.793488}
[0m11:07:02.742208 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:02.742129 after 4.93 seconds
[0m11:07:02.742493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ad3dade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4ac5aa570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e4acb8eae0>]}
[0m11:07:02.742806 [debug] [MainThread]: Flushing usage events
[0m11:07:03.690994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:06.075115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb657267fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6572df0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb657264e30>]}


============================== 11:19:06.079980 | a51d37fb-988f-4847-ae9a-afe3b45b0945 ==============================
[0m11:19:06.079980 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:19:06.080536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:19:06.975369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb64802d880>]}
[0m11:19:07.036371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb641ae8e30>]}
[0m11:19:07.037673 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:19:07.147266 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:19:07.394617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:07.395040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:07.435796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6411af8c0>]}
[0m11:19:07.525396 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:19:07.527738 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:19:07.545903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb640e68380>]}
[0m11:19:07.546344 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m11:19:07.546725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6411acce0>]}
[0m11:19:07.548232 [info ] [MainThread]: 
[0m11:19:07.548666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:07.549028 [info ] [MainThread]: 
[0m11:19:07.549573 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:19:07.555305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m11:19:07.664095 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m11:19:07.664455 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m11:19:07.664712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:09.238501 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.574 seconds
[0m11:19:09.243483 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m11:19:09.244169 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m11:19:09.721344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.476 seconds
[0m11:19:09.728232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m11:19:09.746298 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m11:19:09.746714 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m11:19:10.062248 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.315 seconds
[0m11:19:10.065972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m11:19:10.069427 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m11:19:10.069761 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m11:19:10.390514 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.320 seconds
[0m11:19:10.395371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb640bef0b0>]}
[0m11:19:10.403211 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m11:19:10.403726 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m11:19:10.404270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now model.clinicaltrials.stg_ctgov__studies)
[0m11:19:10.404578 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m11:19:10.410589 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:10.413533 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m11:19:10.442121 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:10.446306 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:10.446755 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:19:11.594614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.147 seconds
[0m11:19:11.612790 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:11.613216 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:19:12.072652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m11:19:12.085858 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:12.086347 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m11:19:12.402077 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.315 seconds
[0m11:19:12.414560 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m11:19:12.414983 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m11:19:12.742854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m11:19:12.757813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb63bfe0ce0>]}
[0m11:19:12.758558 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 2.35s]
[0m11:19:12.759129 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m11:19:12.760168 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m11:19:12.760527 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m11:19:12.760872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m11:19:12.761137 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m11:19:12.763585 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m11:19:12.764815 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m11:19:12.767076 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m11:19:12.768715 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:19:12.769026 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:19:14.088678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.319 seconds
[0m11:19:14.091376 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:19:14.091841 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:19:14.391251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m11:19:14.393985 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:19:14.394477 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m11:19:14.689870 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.295 seconds
[0m11:19:14.696226 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m11:19:14.696635 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m11:19:15.079164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m11:19:15.082803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51d37fb-988f-4847-ae9a-afe3b45b0945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb63be08a70>]}
[0m11:19:15.083638 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 2.32s]
[0m11:19:15.084396 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m11:19:15.086230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:15.086738 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m11:19:15.087120 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m11:19:15.617799 [info ] [MainThread]: 
[0m11:19:15.619200 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m11:19:15.620962 [debug] [MainThread]: Command end result
[0m11:19:15.644309 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:19:15.645741 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:19:15.650760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m11:19:15.651134 [info ] [MainThread]: 
[0m11:19:15.651480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:15.651709 [info ] [MainThread]: 
[0m11:19:15.651986 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:19:15.652785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.853694, "process_in_blocks": "38464", "process_kernel_time": 0.759411, "process_mem_max_rss": "218556", "process_out_blocks": "3264", "process_user_time": 3.666743}
[0m11:19:15.653233 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:15.653147 after 9.85 seconds
[0m11:19:15.653533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6572df0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6401aff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb640df23c0>]}
[0m11:19:15.653813 [debug] [MainThread]: Flushing usage events
[0m11:19:17.002993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:23.935692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786d0fd7d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786d1061b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786d0ff76cc0>]}


============================== 11:19:23.943584 | f59a2e18-5ccd-4ec9-bae2-ea210dc798a0 ==============================
[0m11:19:23.943584 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:19:23.944099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:19:25.669868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf60b8890>]}
[0m11:19:25.742919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf6051e80>]}
[0m11:19:25.743721 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m11:19:25.884989 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:19:26.019266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:19:26.019661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:19:26.072233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf5d8ebd0>]}
[0m11:19:26.179679 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:19:26.181916 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:19:26.206699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf59164e0>]}
[0m11:19:26.207341 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m11:19:26.207709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786d0fc56e70>]}
[0m11:19:26.288280 [info ] [MainThread]: 
[0m11:19:26.288958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:26.289216 [info ] [MainThread]: 
[0m11:19:26.289638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:19:26.290824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage'
[0m11:19:26.336087 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m11:19:26.336501 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m11:19:26.336826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:27.984916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.648 seconds
[0m11:19:27.986827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m11:19:27.991459 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m11:19:27.992044 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m11:19:28.320235 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.328 seconds
[0m11:19:28.322632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f59a2e18-5ccd-4ec9-bae2-ea210dc798a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf5f07b60>]}
[0m11:19:28.326815 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:19:28.327275 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m11:19:28.327719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m11:19:28.328011 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:19:28.353333 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:19:28.356718 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:19:28.385142 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:19:28.387287 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m11:19:28.387887 [debug] [Thread-1 (]: On test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and early_stop_rate >= 0 and early_stop_rate <= 1
)
 as expression


    from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"} */
[0m11:19:28.806258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m11:19:28.818143 [info ] [Thread-1 (]: 1 of 2 PASS dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[32mPASS[0m in 0.49s]
[0m11:19:28.818984 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m11:19:28.819400 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:19:28.819948 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m11:19:28.820591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m11:19:28.821320 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:19:28.827884 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:19:28.828569 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:19:28.831416 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:19:28.832410 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m11:19:28.832774 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m11:19:29.407872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m11:19:29.410854 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.59s]
[0m11:19:29.411471 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m11:19:29.413137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:29.413649 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m11:19:29.414110 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m11:19:29.996969 [info ] [MainThread]: 
[0m11:19:29.997926 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m11:19:29.998940 [debug] [MainThread]: Command end result
[0m11:19:30.031434 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m11:19:30.033817 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m11:19:30.053470 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m11:19:30.053918 [info ] [MainThread]: 
[0m11:19:30.054319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:30.054750 [info ] [MainThread]: 
[0m11:19:30.055133 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:19:30.056013 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.1881123, "process_in_blocks": "1144", "process_kernel_time": 1.07715, "process_mem_max_rss": "219712", "process_out_blocks": "3232", "process_user_time": 4.655323}
[0m11:19:30.056433 [debug] [MainThread]: Command `dbt test` succeeded at 11:19:30.056350 after 6.19 seconds
[0m11:19:30.056729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786d0fdb9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf5d8ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786cf59165d0>]}
[0m11:19:30.057012 [debug] [MainThread]: Flushing usage events
[0m11:19:31.048775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:38.509682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b23ac8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b21a40fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b21dba9f0>]}


============================== 12:10:38.516712 | 0564ba93-c8da-4f78-882e-4ce3eac314fe ==============================
[0m12:10:38.516712 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:10:38.517228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'debug': 'False', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:39.413432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b21b9e1e0>]}
[0m12:10:39.501011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b07e97fb0>]}
[0m12:10:39.502660 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m12:10:39.661340 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:10:39.937379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:39.937821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:39.991996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b07af0410>]}
[0m12:10:40.094714 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m12:10:40.096928 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m12:10:40.112578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b07921ca0>]}
[0m12:10:40.112986 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m12:10:40.113285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b0c22ef30>]}
[0m12:10:40.114712 [info ] [MainThread]: 
[0m12:10:40.115056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:40.115303 [info ] [MainThread]: 
[0m12:10:40.115700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:40.119576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV'
[0m12:10:40.226075 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m12:10:40.226520 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m12:10:40.226797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:59.423975 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 19.197 seconds
[0m12:10:59.430232 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV"
[0m12:10:59.430920 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV: show terse schemas in database DB_CLINICAL_TRIALS_GOV
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV"} */
[0m12:11:00.789083 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.358 seconds
[0m12:11:00.792953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m12:11:00.804488 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m12:11:00.804867 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m12:11:02.127078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.322 seconds
[0m12:11:02.130526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur)
[0m12:11:02.135204 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m12:11:02.135766 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m12:11:03.307983 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.171 seconds
[0m12:11:03.317318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b07df7fb0>]}
[0m12:11:03.327427 [debug] [Thread-1 (]: Began running node model.clinicaltrials.stg_ctgov__studies
[0m12:11:03.328347 [info ] [Thread-1 (]: 1 of 2 START sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies ... [RUN]
[0m12:11:03.328886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now model.clinicaltrials.stg_ctgov__studies)
[0m12:11:03.329245 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.stg_ctgov__studies
[0m12:11:03.339394 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:03.341691 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.stg_ctgov__studies
[0m12:11:03.376306 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:03.379791 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:03.380433 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
    
    
    
    as (

WITH raw AS (
  SELECT
    payload:protocolSection.identificationModule.nctId::STRING AS nct_id,
    payload:protocolSection.statusModule.overallStatus::STRING AS overall_status,
    payload:protocolSection.sponsorCollaboratorsModule.leadSponsor.class::STRING AS sponsor_class,
    payload:protocolSection.statusModule.completionDateStruct.date::STRING AS completion_date,
    payload:protocolSection.statusModule.primaryCompletionDateStruct.date::STRING AS primary_completion_date,
    payload:protocolSection.statusModule.studyFirstSubmitDate::DATE AS first_submit_date,
    payload:protocolSection.designModule.studyType::STRING AS study_type,
    payload:protocolSection.designModule.phases[0]::STRING AS phase
  FROM DB_CLINICAL_TRIALS_GOV.SH_CLINICAL_TRIALS_GOV_RAW.RAW_CTGOV__STUDIES
)
SELECT
  nct_id,
  overall_status,
  completion_date,
  sponsor_class,
  study_type,
  phase,
  primary_completion_date,
  first_submit_date
FROM raw
/*WHERE study_type = 'Interventional'
  AND phase IN ('Phase 2', 'Phase 3')
  AND first_submit_date >= '2015-01-01'
*/
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m12:11:05.777303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.396 seconds
[0m12:11:05.815420 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:05.816072 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies IS $$Flattened clinical trial studies from raw JSON$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m12:11:06.503842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m12:11:06.525035 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:06.525561 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */
[0m12:11:07.589007 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.063 seconds
[0m12:11:07.609040 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.stg_ctgov__studies"
[0m12:11:07.609501 [debug] [Thread-1 (]: On model.clinicaltrials.stg_ctgov__studies: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies alter
    
        "NCT_ID" COMMENT $$$$,
    
        "OVERALL_STATUS" COMMENT $$$$,
    
        "COMPLETION_DATE" COMMENT $$$$,
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "STUDY_TYPE" COMMENT $$$$,
    
        "PHASE" COMMENT $$Trial phase, either Phase 2 or Phase 3$$,
    
        "PRIMARY_COMPLETION_DATE" COMMENT $$$$,
    
        "FIRST_SUBMIT_DATE" COMMENT $$First submitted date for the trial$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.stg_ctgov__studies"} */;
[0m12:12:41.576304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 93.966 seconds
[0m12:12:41.595430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b068ac6b0>]}
[0m12:12:41.596467 [info ] [Thread-1 (]: 1 of 2 OK created sql table model sh_clinical_trials_gov_stage.stg_ctgov__studies  [[32mSUCCESS 1[0m in 98.26s]
[0m12:12:41.597542 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.stg_ctgov__studies
[0m12:12:41.600649 [debug] [Thread-1 (]: Began running node model.clinicaltrials.int_sponsor_summary
[0m12:12:41.601642 [info ] [Thread-1 (]: 2 of 2 START sql table model sh_clinical_trials_gov_cur.int_sponsor_summary .... [RUN]
[0m12:12:41.602308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.clinicaltrials.stg_ctgov__studies, now model.clinicaltrials.int_sponsor_summary)
[0m12:12:41.602889 [debug] [Thread-1 (]: Began compiling node model.clinicaltrials.int_sponsor_summary
[0m12:12:41.608075 [debug] [Thread-1 (]: Writing injected SQL for node "model.clinicaltrials.int_sponsor_summary"
[0m12:12:41.609559 [debug] [Thread-1 (]: Began executing node model.clinicaltrials.int_sponsor_summary
[0m12:12:41.613265 [debug] [Thread-1 (]: Writing runtime sql for node "model.clinicaltrials.int_sponsor_summary"
[0m12:12:41.615699 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m12:12:41.616186 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: create or replace transient table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    
    
    
    as (

SELECT
  sponsor_class,
  COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED')) AS early_stopped_trials,
  COUNT_IF(overall_status IN ('COMPLETED', 'Terminated', 'WITHDRAWN', 'SUSPENDED')) AS total_closed_trials,
  ROUND(
    COUNT_IF(overall_status IN ('TERMINATED', 'WITHDRAWN', 'SUSPENDED'))::FLOAT
    / NULLIF(COUNT_IF(overall_status IN ('COMPLETED', 'TERMINATED', 'WITHDRAWN', 'SUSPENDED')), 0),
    3
  ) AS early_stop_rate
FROM DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
GROUP BY sponsor_class
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m12:12:47.645088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.028 seconds
[0m12:12:47.655519 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m12:12:47.656164 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: comment on table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary IS $$Aggregated summary of early stopped trials by sponsor class$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m12:13:38.831972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 51.175 seconds
[0m12:13:38.845515 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m12:13:38.846066 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: describe table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */
[0m12:14:00.258280 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 21.411 seconds
[0m12:14:00.317649 [debug] [Thread-1 (]: Using snowflake connection "model.clinicaltrials.int_sponsor_summary"
[0m12:14:00.318970 [debug] [Thread-1 (]: On model.clinicaltrials.int_sponsor_summary: alter  table DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary alter
    
        "SPONSOR_CLASS" COMMENT $$$$,
    
        "EARLY_STOPPED_TRIALS" COMMENT $$$$,
    
        "TOTAL_CLOSED_TRIALS" COMMENT $$$$,
    
        "EARLY_STOP_RATE" COMMENT $$$$
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "model.clinicaltrials.int_sponsor_summary"} */;
[0m12:14:04.525696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.205 seconds
[0m12:14:04.534041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0564ba93-c8da-4f78-882e-4ce3eac314fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b06892bd0>]}
[0m12:14:04.536988 [info ] [Thread-1 (]: 2 of 2 OK created sql table model sh_clinical_trials_gov_cur.int_sponsor_summary  [[32mSUCCESS 1[0m in 82.93s]
[0m12:14:04.544104 [debug] [Thread-1 (]: Finished running node model.clinicaltrials.int_sponsor_summary
[0m12:14:04.556745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:04.558598 [debug] [MainThread]: Connection 'model.clinicaltrials.int_sponsor_summary' was left open.
[0m12:14:04.560243 [debug] [MainThread]: On model.clinicaltrials.int_sponsor_summary: Close
[0m12:14:05.725342 [info ] [MainThread]: 
[0m12:14:05.727254 [info ] [MainThread]: Finished running 2 table models in 0 hours 3 minutes and 25.61 seconds (205.61s).
[0m12:14:05.732321 [debug] [MainThread]: Command end result
[0m12:14:05.830836 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m12:14:05.835812 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m12:14:05.847870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m12:14:05.848540 [info ] [MainThread]: 
[0m12:14:05.849391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:05.850661 [info ] [MainThread]: 
[0m12:14:05.853360 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:14:05.861706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 207.40823, "process_in_blocks": "38728", "process_kernel_time": 0.852467, "process_mem_max_rss": "218552", "process_out_blocks": "3288", "process_user_time": 3.99647}
[0m12:14:05.862661 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:05.862496 after 207.41 seconds
[0m12:14:05.863200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b22173770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b2205cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750b2205d730>]}
[0m12:14:05.863645 [debug] [MainThread]: Flushing usage events
[0m12:14:07.727510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:14.811280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545aa6bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545cbd4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545a802e70>]}


============================== 12:14:14.815682 | ef21cd56-b180-4454-9980-f1eebd9bbc60 ==============================
[0m12:14:14.815682 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:14:14.816399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/reach2zeeshan/clinicaltrials/logs', 'version_check': 'True', 'profiles_dir': '/home/reach2zeeshan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:15.714975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735445c3c110>]}
[0m12:14:15.775435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545aaa15b0>]}
[0m12:14:15.776490 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m12:14:15.884763 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:14:16.015219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:16.015568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:16.069283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735444b45970>]}
[0m12:14:16.171563 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m12:14:16.173866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m12:14:16.198556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735444753b60>]}
[0m12:14:16.198996 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 743 macros
[0m12:14:16.199297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735444af75c0>]}
[0m12:14:16.279978 [info ] [MainThread]: 
[0m12:14:16.280511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:16.280880 [info ] [MainThread]: 
[0m12:14:16.281406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:16.282779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur'
[0m12:14:16.331003 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"
[0m12:14:16.331694 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur"} */;
[0m12:14:16.332048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:47.555634 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 31.223 seconds
[0m12:14:47.561227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_cur, now list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage)
[0m12:14:47.568265 [debug] [ThreadPool]: Using snowflake connection "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"
[0m12:14:47.568840 [debug] [ThreadPool]: On list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage: show objects in DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "connection_name": "list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage"} */;
[0m12:14:48.008962 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.440 seconds
[0m12:14:48.014128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef21cd56-b180-4454-9980-f1eebd9bbc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7354441b5f10>]}
[0m12:14:48.019225 [debug] [Thread-1 (]: Began running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m12:14:48.019715 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [RUN]
[0m12:14:48.020221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DB_CLINICAL_TRIALS_GOV_sh_clinical_trials_gov_stage, now test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba)
[0m12:14:48.020610 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m12:14:48.044776 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m12:14:48.046277 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m12:14:48.076873 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m12:14:48.080282 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"
[0m12:14:48.080731 [debug] [Thread-1 (]: On test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and early_stop_rate >= 0 and early_stop_rate <= 1
)
 as expression


    from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_cur.int_sponsor_summary
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba"} */
[0m12:14:48.741156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m12:14:48.766774 [info ] [Thread-1 (]: 1 of 2 PASS dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False  [[32mPASS[0m in 0.75s]
[0m12:14:48.768322 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba
[0m12:14:48.769182 [debug] [Thread-1 (]: Began running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m12:14:48.770542 [info ] [Thread-1 (]: 2 of 2 START test not_null_stg_ctgov__studies_nct_id ........................... [RUN]
[0m12:14:48.771528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.clinicaltrials.dbt_expectations_expect_column_values_to_be_between_int_sponsor_summary_early_stop_rate__1__0__False.5280ad6fba, now test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce)
[0m12:14:48.772293 [debug] [Thread-1 (]: Began compiling node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m12:14:48.784192 [debug] [Thread-1 (]: Writing injected SQL for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m12:14:48.785426 [debug] [Thread-1 (]: Began executing node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m12:14:48.790168 [debug] [Thread-1 (]: Writing runtime sql for node "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m12:14:48.791691 [debug] [Thread-1 (]: Using snowflake connection "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"
[0m12:14:48.792297 [debug] [Thread-1 (]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nct_id
from DB_CLINICAL_TRIALS_GOV.sh_clinical_trials_gov_stage.stg_ctgov__studies
where nct_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "clinicaltrials", "target_name": "dev", "node_id": "test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce"} */
[0m12:14:49.452527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m12:14:49.455991 [info ] [Thread-1 (]: 2 of 2 PASS not_null_stg_ctgov__studies_nct_id ................................. [[32mPASS[0m in 0.68s]
[0m12:14:49.456631 [debug] [Thread-1 (]: Finished running node test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce
[0m12:14:49.459007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:49.459314 [debug] [MainThread]: Connection 'test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce' was left open.
[0m12:14:49.459556 [debug] [MainThread]: On test.clinicaltrials.not_null_stg_ctgov__studies_nct_id.929f7c30ce: Close
[0m12:14:50.529388 [info ] [MainThread]: 
[0m12:14:50.531248 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 34.25 seconds (34.25s).
[0m12:14:50.535719 [debug] [MainThread]: Command end result
[0m12:14:50.590304 [debug] [MainThread]: Wrote artifact WritableManifest to /home/reach2zeeshan/clinicaltrials/target/manifest.json
[0m12:14:50.592604 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/reach2zeeshan/clinicaltrials/target/semantic_manifest.json
[0m12:14:50.598595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/reach2zeeshan/clinicaltrials/target/run_results.json
[0m12:14:50.599177 [info ] [MainThread]: 
[0m12:14:50.599627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:50.600008 [info ] [MainThread]: 
[0m12:14:50.600484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:14:50.602089 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 35.868282, "process_in_blocks": "1144", "process_kernel_time": 0.46789, "process_mem_max_rss": "219696", "process_out_blocks": "3240", "process_user_time": 3.604788}
[0m12:14:50.602660 [debug] [MainThread]: Command `dbt test` succeeded at 12:14:50.602541 after 35.87 seconds
[0m12:14:50.603015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545c017830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545aafe1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73545aafe5a0>]}
[0m12:14:50.603302 [debug] [MainThread]: Flushing usage events
[0m12:14:51.878079 [debug] [MainThread]: An error was encountered while trying to flush usage events
